	 EVEN
md5_process:
	lea -84(sp),sp
	 movem.l #$1f3e,-(sp)
	move.l 128(sp),a4
	move.l 8(a4),d6
	move.l d6,52(sp)
	move.l 12(a4),d7
	move.l d7,48(sp)
	move.l 16(a4),a5
	move.l a5,44(sp)
	move.l 20(a4),a6
	move.l a6,40(sp)
	move.l 132(sp),a0
	moveq.l #0,d5
	moveq.l #0,d4
	lea 56(sp),a1
	moveq.l #0,d3
	moveq.l #15,d2
	 EVEN
LMd56:
	move.b (a0),d5
	move.b 1(a0),d4
	move.l d4,d0
	lsl.l #8,d0
	add.l d5,d0
	move.b 2(a0),d3
	move.l d3,d1
	swap d1
	clr.w d1
	add.l d1,d0
	move.b 3(a0),d1
	lsl.w #8,d1
	swap d1
	clr.w d1
	add.l d1,d0
	move.l d0,(a1)+
	subq.l #1,d2
	addq.l #4,a0
	 bpl LMd56
	move.l a5,d0
	and.l d7,d0
	move.l d7,d1
	not.l d1
	move.l a6,d2
	and.l d2,d1
	or.l d1,d0
	add.l d6,d0
	add.l 56(sp),d0
	add.l #-680876936,d0
	rol.l #7,d0
	move.l d0,d6
	add.l d7,d6
	move.l d6,d0
	and.l d7,d0
	move.l d6,d1
	not.l d1
	move.l a5,d2
	and.l d2,d1
	or.l d1,d0
	add.l a6,d0
	add.l 60(sp),d0
	add.l #-389564586,d0
	moveq.l #12,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	and.l d6,d0
	move.l a6,d1
	not.l d1
	and.l d7,d1
	or.l d1,d0
	add.l a5,d0
	add.l 64(sp),d0
	add.l #606105819,d0
	moveq.l #17,d2
	rol.l d2,d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	move.l a6,d1
	and.l d1,d0
	move.l a5,d1
	not.l d1
	and.l d6,d1
	or.l d1,d0
	add.l d7,d0
	add.l 68(sp),d0
	add.l #-1044525330,d0
	moveq.l #22,d2
	rol.l d2,d0
	move.l d0,d7
	add.l a5,d7
	move.l a5,d0
	and.l d7,d0
	move.l d7,d1
	not.l d1
	move.l a6,d2
	and.l d2,d1
	or.l d1,d0
	add.l d6,d0
	add.l 72(sp),d0
	add.l #-176418897,d0
	rol.l #7,d0
	move.l d0,d6
	add.l d7,d6
	move.l d6,d0
	and.l d7,d0
	move.l d6,d1
	not.l d1
	move.l a5,d2
	and.l d2,d1
	or.l d1,d0
	add.l a6,d0
	move.l 76(sp),a1
	add.l a1,d0
	add.l #1200080426,d0
	moveq.l #12,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	and.l d6,d0
	move.l a6,d1
	not.l d1
	and.l d7,d1
	or.l d1,d0
	add.l a5,d0
	add.l 80(sp),d0
	add.l #-1473231341,d0
	moveq.l #17,d2
	rol.l d2,d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	move.l a6,d1
	and.l d1,d0
	move.l a5,d1
	not.l d1
	and.l d6,d1
	or.l d1,d0
	add.l d7,d0
	move.l 84(sp),a2
	add.l a2,d0
	add.l #-45705983,d0
	moveq.l #22,d2
	rol.l d2,d0
	move.l d0,d7
	add.l a5,d7
	move.l a5,d0
	and.l d7,d0
	move.l d7,d1
	not.l d1
	move.l a6,d2
	and.l d2,d1
	or.l d1,d0
	add.l d6,d0
	add.l 88(sp),d0
	add.l #1770035416,d0
	rol.l #7,d0
	move.l d0,d6
	add.l d7,d6
	move.l d6,d0
	and.l d7,d0
	move.l d6,d1
	not.l d1
	move.l a5,d2
	and.l d2,d1
	or.l d1,d0
	add.l a6,d0
	add.l 92(sp),d0
	add.l #-1958414417,d0
	moveq.l #12,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	and.l d6,d0
	move.l a6,d1
	not.l d1
	and.l d7,d1
	or.l d1,d0
	add.l a5,d0
	move.l 96(sp),a0
	add.l a0,d0
	add.l #-42063,d0
	moveq.l #17,d2
	rol.l d2,d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	move.l a6,d1
	and.l d1,d0
	move.l a5,d1
	not.l d1
	and.l d6,d1
	or.l d1,d0
	add.l d7,d0
	add.l 100(sp),d0
	add.l #-1990404162,d0
	moveq.l #22,d2
	rol.l d2,d0
	move.l d0,d7
	add.l a5,d7
	move.l a5,d0
	and.l d7,d0
	move.l d7,d1
	not.l d1
	move.l a6,d2
	and.l d2,d1
	or.l d1,d0
	add.l d6,d0
	move.l 104(sp),d5
	add.l d5,d0
	add.l #1804603682,d0
	rol.l #7,d0
	move.l d0,d6
	add.l d7,d6
	move.l d6,d0
	and.l d7,d0
	move.l d6,d1
	not.l d1
	move.l a5,d2
	and.l d2,d1
	or.l d1,d0
	add.l a6,d0
	add.l 108(sp),d0
	add.l #-40341101,d0
	moveq.l #12,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	and.l d6,d0
	move.l a6,d3
	not.l d3
	move.l d3,d1
	and.l d7,d1
	or.l d1,d0
	add.l a5,d0
	move.l 112(sp),d4
	add.l d4,d0
	add.l #-1502002290,d0
	moveq.l #17,d2
	rol.l d2,d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	move.l a6,d1
	and.l d1,d0
	move.l a5,d2
	not.l d2
	move.l d2,d1
	and.l d6,d1
	or.l d1,d0
	add.l d7,d0
	move.l 116(sp),a3
	add.l a3,d0
	add.l #1236535329,d0
	moveq.l #22,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	move.l a6,d0
	and.l d7,d0
	move.l a5,d1
	and.l d3,d1
	or.l d1,d0
	add.l d6,d0
	add.l 60(sp),d0
	add.l #-165796510,d0
	rol.l #5,d0
	move.l d0,d6
	add.l d7,d6
	move.l a5,d0
	and.l d6,d0
	move.l d7,d1
	and.l d2,d1
	or.l d1,d0
	add.l a6,d0
	add.l 80(sp),d0
	add.l #-1069501632,d0
	moveq.l #9,d2
	rol.l d2,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	and.l d7,d0
	move.l d7,d1
	not.l d1
	and.l d6,d1
	or.l d1,d0
	add.l a5,d0
	add.l 100(sp),d0
	add.l #643717713,d0
	moveq.l #14,d1
	rol.l d1,d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	and.l d6,d0
	move.l d6,d1
	not.l d1
	move.l a6,d2
	and.l d2,d1
	or.l d1,d0
	add.l d7,d0
	add.l 56(sp),d0
	add.l #-373897302,d0
	moveq.l #20,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	move.l a6,d0
	and.l d7,d0
	move.l a6,d1
	not.l d1
	move.l a5,d2
	and.l d2,d1
	or.l d1,d0
	add.l d6,d0
	add.l a1,d0
	add.l #-701558691,d0
	rol.l #5,d0
	move.l d0,d6
	add.l d7,d6
	move.l a5,d0
	and.l d6,d0
	move.l a5,d1
	not.l d1
	and.l d7,d1
	or.l d1,d0
	add.l a6,d0
	add.l a0,d0
	add.l #38016083,d0
	moveq.l #9,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	and.l d7,d0
	move.l d7,d1
	not.l d1
	and.l d6,d1
	or.l d1,d0
	add.l a5,d0
	add.l a3,d0
	add.l #-660478335,d0
	moveq.l #14,d2
	rol.l d2,d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	and.l d6,d0
	move.l d6,d1
	not.l d1
	move.l a6,d2
	and.l d2,d1
	or.l d1,d0
	add.l d7,d0
	add.l 72(sp),d0
	add.l #-405537848,d0
	moveq.l #20,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	move.l a6,d0
	and.l d7,d0
	move.l a6,d1
	not.l d1
	move.l a5,d2
	and.l d2,d1
	or.l d1,d0
	add.l d6,d0
	add.l 92(sp),d0
	add.l #568446438,d0
	rol.l #5,d0
	move.l d0,d6
	add.l d7,d6
	move.l a5,d0
	and.l d6,d0
	move.l a5,d1
	not.l d1
	and.l d7,d1
	or.l d1,d0
	add.l a6,d0
	add.l d4,d0
	add.l #-1019803690,d0
	moveq.l #9,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	and.l d7,d0
	move.l d7,d1
	not.l d1
	and.l d6,d1
	or.l d1,d0
	add.l a5,d0
	add.l 68(sp),d0
	add.l #-187363961,d0
	moveq.l #14,d2
	rol.l d2,d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	and.l d6,d0
	move.l d6,d1
	not.l d1
	move.l a6,d2
	and.l d2,d1
	or.l d1,d0
	add.l d7,d0
	add.l 88(sp),d0
	add.l #1163531501,d0
	moveq.l #20,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	move.l a6,d0
	and.l d7,d0
	move.l a6,d1
	not.l d1
	move.l a5,d2
	and.l d2,d1
	or.l d1,d0
	add.l d6,d0
	add.l 108(sp),d0
	add.l #-1444681467,d0
	rol.l #5,d0
	move.l d0,d6
	add.l d7,d6
	move.l a5,d0
	and.l d6,d0
	move.l a5,d1
	not.l d1
	and.l d7,d1
	or.l d1,d0
	add.l a6,d0
	add.l 64(sp),d0
	add.l #-51403784,d0
	moveq.l #9,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	and.l d7,d0
	move.l d7,d1
	not.l d1
	and.l d6,d1
	or.l d1,d0
	add.l a5,d0
	add.l a2,d0
	add.l #1735328473,d0
	moveq.l #14,d2
	rol.l d2,d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	and.l d6,d0
	move.l d6,d1
	not.l d1
	move.l a6,d2
	and.l d2,d1
	or.l d1,d0
	add.l d7,d0
	add.l d5,d0
	add.l #-1926607734,d0
	moveq.l #20,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	move.l a5,d0
	eor.l d7,d0
	eor.l d2,d0
	add.l d6,d0
	add.l a1,d0
	add.l #-378558,d0
	rol.l #4,d0
	move.l d0,d6
	add.l d7,d6
	move.l d6,d0
	eor.l d7,d0
	move.l a5,d2
	eor.l d2,d0
	add.l a6,d0
	add.l 88(sp),d0
	add.l #-2022574463,d0
	moveq.l #11,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	eor.l d6,d0
	eor.l d7,d0
	add.l a5,d0
	add.l 100(sp),d0
	add.l #1839030562,d0
	swap d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	move.l a6,d2
	eor.l d2,d0
	eor.l d6,d0
	add.l d7,d0
	add.l d4,d0
	add.l #-35309556,d0
	moveq.l #23,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	move.l a5,d0
	eor.l d7,d0
	eor.l d2,d0
	add.l d6,d0
	add.l 60(sp),d0
	add.l #-1530992060,d0
	rol.l #4,d0
	move.l d0,d6
	add.l d7,d6
	move.l d6,d0
	eor.l d7,d0
	move.l a5,d2
	eor.l d2,d0
	add.l a6,d0
	add.l 72(sp),d0
	add.l #1272893353,d0
	moveq.l #11,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	eor.l d6,d0
	eor.l d7,d0
	add.l a5,d0
	add.l a2,d0
	add.l #-155497632,d0
	swap d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	move.l a6,d2
	eor.l d2,d0
	eor.l d6,d0
	add.l d7,d0
	add.l a0,d0
	add.l #-1094730640,d0
	moveq.l #23,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	move.l a5,d0
	eor.l d7,d0
	eor.l d2,d0
	add.l d6,d0
	add.l 108(sp),d0
	add.l #681279174,d0
	rol.l #4,d0
	move.l d0,d6
	add.l d7,d6
	move.l d6,d0
	eor.l d7,d0
	move.l a5,d2
	eor.l d2,d0
	add.l a6,d0
	add.l 56(sp),d0
	add.l #-358537222,d0
	moveq.l #11,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	eor.l d6,d0
	eor.l d7,d0
	add.l a5,d0
	add.l 68(sp),d0
	add.l #-722521979,d0
	swap d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	move.l a6,d2
	eor.l d2,d0
	eor.l d6,d0
	add.l d7,d0
	add.l 80(sp),d0
	add.l #76029189,d0
	moveq.l #23,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	move.l a5,d0
	eor.l d7,d0
	eor.l d2,d0
	add.l d6,d0
	add.l 92(sp),d0
	add.l #-640364487,d0
	rol.l #4,d0
	move.l d0,d6
	add.l d7,d6
	move.l d6,d0
	eor.l d7,d0
	move.l a5,d2
	eor.l d2,d0
	add.l a6,d0
	add.l d5,d0
	add.l #-421815835,d0
	moveq.l #11,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l a6,d0
	eor.l d6,d0
	eor.l d7,d0
	add.l a5,d0
	add.l a3,d0
	add.l #530742520,d0
	swap d0
	lea 0(a6,d0.l),a5
	move.l a5,d0
	move.l a6,d2
	eor.l d2,d0
	eor.l d6,d0
	add.l d7,d0
	add.l 64(sp),d0
	add.l #-995338651,d0
	moveq.l #23,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	move.l a6,d0
	not.l d0
	or.l d7,d0
	move.l a5,d2
	eor.l d2,d0
	add.l d6,d0
	add.l 56(sp),d0
	add.l #-198630844,d0
	rol.l #6,d0
	move.l d0,d6
	add.l d7,d6
	move.l a5,d0
	not.l d0
	or.l d6,d0
	eor.l d7,d0
	add.l a6,d0
	add.l a2,d0
	add.l #1126891415,d0
	moveq.l #10,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l d7,d0
	not.l d0
	move.l a6,d2
	or.l d2,d0
	eor.l d6,d0
	add.l a5,d0
	add.l d4,d0
	add.l #-1416354905,d0
	moveq.l #15,d1
	rol.l d1,d0
	lea 0(a6,d0.l),a5
	move.l d6,d0
	not.l d0
	move.l a5,d2
	or.l d2,d0
	move.l a6,d1
	eor.l d1,d0
	add.l d7,d0
	add.l a1,d0
	add.l #-57434055,d0
	moveq.l #21,d2
	rol.l d2,d0
	move.l d0,d7
	add.l a5,d7
	move.l a6,d0
	not.l d0
	or.l d7,d0
	move.l a5,d1
	eor.l d1,d0
	add.l d6,d0
	add.l d5,d0
	add.l #1700485571,d0
	rol.l #6,d0
	move.l d0,d6
	add.l d7,d6
	move.l a5,d0
	not.l d0
	or.l d6,d0
	eor.l d7,d0
	add.l a6,d0
	add.l 68(sp),d0
	add.l #-1894986606,d0
	moveq.l #10,d2
	rol.l d2,d0
	move.l d0,a6
	add.l d6,a6
	move.l d7,d0
	not.l d0
	move.l a6,d1
	or.l d1,d0
	eor.l d6,d0
	add.l a5,d0
	add.l a0,d0
	add.l #-1051523,d0
	moveq.l #15,d2
	rol.l d2,d0
	lea 0(a6,d0.l),a5
	move.l d6,d0
	not.l d0
	move.l a5,d1
	or.l d1,d0
	move.l a6,d2
	eor.l d2,d0
	add.l d7,d0
	add.l 60(sp),d0
	add.l #-2054922799,d0
	moveq.l #21,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	move.l a6,d0
	not.l d0
	or.l d7,d0
	move.l a5,d2
	eor.l d2,d0
	add.l d6,d0
	add.l 88(sp),d0
	add.l #1873313359,d0
	rol.l #6,d0
	move.l d0,d6
	add.l d7,d6
	move.l a5,d0
	not.l d0
	or.l d6,d0
	eor.l d7,d0
	add.l a6,d0
	add.l a3,d0
	add.l #-30611744,d0
	moveq.l #10,d1
	rol.l d1,d0
	move.l d0,a6
	add.l d6,a6
	move.l d7,d0
	not.l d0
	move.l a6,d2
	or.l d2,d0
	eor.l d6,d0
	add.l a5,d0
	add.l 80(sp),d0
	add.l #-1560198380,d0
	moveq.l #15,d1
	rol.l d1,d0
	lea 0(a6,d0.l),a5
	move.l d6,d0
	not.l d0
	move.l a5,d2
	or.l d2,d0
	move.l a6,d1
	eor.l d1,d0
	add.l d7,d0
	add.l 108(sp),d0
	add.l #1309151649,d0
	moveq.l #21,d2
	rol.l d2,d0
	move.l d0,d7
	add.l a5,d7
	move.l a6,d0
	not.l d0
	or.l d7,d0
	move.l a5,d1
	eor.l d1,d0
	add.l d6,d0
	add.l 72(sp),d0
	add.l #-145523070,d0
	rol.l #6,d0
	move.l d0,d6
	add.l d7,d6
	move.l a5,d0
	not.l d0
	or.l d6,d0
	eor.l d7,d0
	add.l a6,d0
	add.l 100(sp),d0
	add.l #-1120210379,d0
	moveq.l #10,d2
	rol.l d2,d0
	move.l d0,a6
	add.l d6,a6
	move.l d7,d0
	not.l d0
	move.l a6,d1
	or.l d1,d0
	eor.l d6,d0
	add.l a5,d0
	add.l 64(sp),d0
	add.l #718787259,d0
	moveq.l #15,d2
	rol.l d2,d0
	lea 0(a6,d0.l),a5
	move.l d6,d0
	not.l d0
	move.l a5,d1
	or.l d1,d0
	move.l a6,d2
	eor.l d2,d0
	add.l d7,d0
	add.l 92(sp),d0
	add.l #-343485551,d0
	moveq.l #21,d1
	rol.l d1,d0
	move.l d0,d7
	add.l a5,d7
	add.l 52(sp),d6
	move.l d6,8(a4)
	add.l 48(sp),d7
	move.l d7,12(a4)
	add.l 44(sp),a5
	move.l a5,16(a4)
	add.l 40(sp),a6
	move.l a6,20(a4)
	 movem.l (sp)+,#$7cf8
	lea 84(sp),sp
	rts
	 EVEN
	 xdef	MD5Init
MD5Init:
	move.l 4(sp),a0
	clr.l 4(a0)
	clr.l (a0)
	move.l #1732584193,8(a0)
	move.l #-271733879,12(a0)
	move.l #-1732584194,16(a0)
	move.l #271733878,20(a0)
	rts
	 EVEN
	 xdef	MD5Update
MD5Update:
	 movem.l #$183e,-(sp)
	move.l 32(sp),a4
	move.l 36(sp),a5
	move.l 40(sp),a6
	move.l a5,a3
	move.l a6,a2
	move.l (a4),d4
	move.l d4,d3
	lsr.l #3,d3
	moveq.l #63,d0
	and.l d0,d3
	move.l a6,d1
	lsl.l #3,d1
	cmp.w #0,a6
	 ble LMd510
	move.l a6,d0
	moveq.l #29,d2
	asr.l d2,d0
	move.l 4(a4),d2
	add.l d0,d2
	move.l d2,4(a4)
	move.l d4,d0
	add.l d1,d0
	move.l d0,(a4)
	cmp.l d0,d1
	 bls LMd512
	addq.l #1,d2
	move.l d2,4(a4)
LMd512:
	tst.l d3
	 beq LMd513
	move.l d3,d0
	add.l a2,d0
	moveq.l #64,d4
	sub.l d3,d4
	moveq.l #64,d1
	cmp.l d0,d1
	 blt LMd515
	move.l a2,d4
LMd515:
	move.l d4,-(sp)
	move.l a5,-(sp)
	pea 24(a4,d3.l)
	 jsr memcpy
	move.l d3,d0
	add.l d4,d0
	lea 12(sp),sp
	moveq.l #63,d2
	cmp.l d0,d2
	 bge LMd510
	lea 0(a5,d4.l),a3
	move.l a6,a2
	sub.l d4,a2
	pea 24(a4)
	move.l a4,-(sp)
	 jsr md5_process
	addq.l #8,sp
LMd513:
	moveq.l #63,d0
	cmp.l a2,d0
	 bge LMd524
	 EVEN
LMd521:
	move.l a3,-(sp)
	move.l a4,-(sp)
	 jsr md5_process
	addq.l #8,sp
	lea 64(a3),a3
	lea -64(a2),a2
	moveq.l #63,d1
	cmp.l a2,d1
	 blt LMd521
LMd524:
	cmp.w #0,a2
	 beq LMd510
	move.l a2,-(sp)
	move.l a3,-(sp)
	pea 24(a4)
	 jsr memcpy
	lea 12(sp),sp
LMd510:
	 movem.l (sp)+,#$7c18
	rts
pad.0:
	 dc.b	-128
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 dc.b	0
	 EVEN
	 xdef	MD5Final
MD5Final:
	link.w a6,#-8
	 movem.l #$1038,-(sp)
	move.l 8(a6),a4
	move.l 12(a6),a3
	moveq.l #0,d2
	moveq.l #0,d3
	lea -8(a6),a0
	 EVEN
LMd530:
	moveq.l #-4,d0
	and.l d2,d0
	moveq.l #3,d1
	and.l d2,d1
	lsl.l #3,d1
	move.l 0(a3,d0.l),d0
	move.w d1,d3
	lsr.l d3,d0
	move.b d0,(a0)+
	addq.l #1,d2
	moveq.l #7,d0
	cmp.l d2,d0
	 bge LMd530
	move.l (a3),d0
	lsr.l #3,d0
	moveq.l #55,d1
	sub.l d0,d1
	move.l d1,d0
	moveq.l #63,d1
	and.l d1,d0
	move.l d0,a0
	pea 1(a0)
	pea (pad.0)
	move.l a3,-(sp)
	lea MD5Update,a2
	 jsr (a2)
	pea (8).w
	pea -8(a6)
	move.l a3,-(sp)
	 jsr (a2)
	moveq.l #0,d2
	lea 24(sp),sp
	moveq.l #0,d3
	 EVEN
LMd535:
	moveq.l #-4,d0
	and.l d2,d0
	moveq.l #3,d1
	and.l d2,d1
	lsl.l #3,d1
	move.l 8(a3,d0.l),d0
	move.w d1,d3
	lsr.l d3,d0
	move.b d0,0(a4,d2.l)
	addq.l #1,d2
	moveq.l #15,d0
	cmp.l d2,d0
	 bge LMd535
	 movem.l -24(a6),#$1c08
	unlk a6
	rts
